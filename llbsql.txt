SELECT HEAD_NO ,BANK_CODE1 ,SELF_ACC_NAME ,ACC_STATE ,SELF_ACC_NO ,CARD_NO ,ACC_TYPE ,ACC_TYPE1 ,	   ID_NO ,CST_NO ,FIXED_FLAG ,ENT_CST_TYPE ,FRG_FLAG ,OPEN_TIME ,CLOSE_TIME ,ACC_FLAG ,CREDIT_FLAG ,	   W_TYPE ,BANK_TEL ,OPEN_TYPE ,OPEN_TYPE1 ,AGENT_NAME ,AGENT_TEL ,AGENT_TYPE ,AGENT_NO from (select A.*, ROW_NUMBER() OVER(PARTITION BY SELF_ACC_NO ORDER BY END_DATE DESC) NUM FROM TB_ACC A WHERE 1=1  and (BEGIN_DATE >=to_date( '20180901' ,'yyyymmdd') and BEGIN_DATE <=to_date( '20180930' ,'yyyymmdd')) or( END_DATE >=to_date( '20180901' ,'yyyymmdd')and END_DATE <=to_date( '20180930' ,'yyyymmdd'))  order by SELF_ACC_NO) B WHERE B.NUM=1